From 77f0cb1855bc3886516214aee76799da10458871 Mon Sep 17 00:00:00 2001
From: Sebastian Lackner <sebastian@fds-team.de>
Date: Thu, 30 Apr 2015 01:37:44 +0200
Subject: advapi32: Add stub for ImpersonateAnonymousToken.

---
 dlls/advapi32/advapi32.spec |  2 +-
 dlls/advapi32/security.c    | 10 ++++++++++
 2 files changed, 11 insertions(+), 1 deletion(-)

diff --git a/dlls/advapi32/advapi32.spec b/dlls/advapi32/advapi32.spec
index e7b7cf7..9fdd266 100644
--- a/dlls/advapi32/advapi32.spec
+++ b/dlls/advapi32/advapi32.spec
@@ -375,7 +375,7 @@
 @ stub I_ScSetServiceBitsA
 # @ stub I_ScSetServiceBitsW
 # @ stub IdentifyCodeAuthzLevelW
-# @ stub ImpersonateAnonymousToken
+@ stdcall ImpersonateAnonymousToken(long)
 @ stdcall ImpersonateLoggedOnUser(long)
 @ stdcall ImpersonateNamedPipeClient(long)
 @ stdcall ImpersonateSelf(long)
diff --git a/dlls/advapi32/security.c b/dlls/advapi32/security.c
index 2362dd5..5bd835c 100644
--- a/dlls/advapi32/security.c
+++ b/dlls/advapi32/security.c
@@ -2504,6 +2504,16 @@ BOOL WINAPI ImpersonateLoggedOnUser(HANDLE hToken)
 }
 
 /******************************************************************************
+ * ImpersonateAnonymousToken [ADVAPI32.@]
+ */
+BOOL WINAPI ImpersonateAnonymousToken(HANDLE hThread)
+{
+    FIXME("(%p)\n", hThread);
+    SetLastError(ERROR_CALL_NOT_IMPLEMENTED);
+    return FALSE;
+}
+
+/******************************************************************************
  * AccessCheck [ADVAPI32.@]
  */
 BOOL WINAPI
-- 
2.3.5

