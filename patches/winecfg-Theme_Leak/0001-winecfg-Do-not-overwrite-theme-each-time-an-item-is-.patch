From 13a30e3966820c04e76e48182e7c2b9a979ecc17 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Michael=20M=C3=BCller?= <michael@fds-team.de>
Date: Sat, 8 Aug 2015 00:52:36 +0200
Subject: winecfg: Do not overwrite theme each time an item is drawn.

Fixes a leak and a use-after-free.
---
 programs/winecfg/theme.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/programs/winecfg/theme.c b/programs/winecfg/theme.c
index 8bc3c88..1f4818b 100644
--- a/programs/winecfg/theme.c
+++ b/programs/winecfg/theme.c
@@ -1094,7 +1094,7 @@ static void on_draw_item(HWND hDlg, WPARAM wParam, LPARAM lParam)
         HTHEME theme;
         RECT buttonrect;
 
-        theme = OpenThemeData(draw_info->hwndItem, WC_BUTTONW);
+        theme = OpenThemeData(NULL, WC_BUTTONW);
 
         if (theme) {
             MARGINS margins;
-- 
2.5.0

