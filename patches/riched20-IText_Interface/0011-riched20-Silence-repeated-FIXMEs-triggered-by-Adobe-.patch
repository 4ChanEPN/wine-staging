From e0ae36a5cdcabb900a2e12a701990f4d0fcc7f7b Mon Sep 17 00:00:00 2001
From: Sebastian Lackner <sebastian@fds-team.de>
Date: Sat, 1 Nov 2014 22:51:34 +0100
Subject: riched20: Silence repeated FIXMEs triggered by Adobe Reader.

Adobe Reader calls these functions very often while scrolling through a document.
---
 dlls/riched20/richole.c | 46 ++++++++++++++++++++++++++++++++++++----------
 1 file changed, 36 insertions(+), 10 deletions(-)

diff --git a/dlls/riched20/richole.c b/dlls/riched20/richole.c
index a2cdcf4..cb12e80 100644
--- a/dlls/riched20/richole.c
+++ b/dlls/riched20/richole.c
@@ -300,6 +300,14 @@ static HRESULT WINAPI IRichEditOleImpl_inner_fnQueryInterface(IUnknown *iface, R
         IUnknown_AddRef((IUnknown *)*ppvObj);
         return S_OK;
     }
+
+    if (IsEqualGUID(riid, &IID_ITextServices))
+    {
+        static int once;
+        if (!once++) FIXME("%p: unhandled interface IID_ITextServices\n", This);
+        return E_NOINTERFACE;
+    }
+
     FIXME("%p: unhandled interface %s\n", This, debugstr_guid(riid));
  
     return E_NOINTERFACE;   
@@ -1961,7 +1969,8 @@ static HRESULT WINAPI TextFont_GetBold(ITextFont *iface, LONG *value)
         return CO_E_RELEASED;
     if (!This->txtRge)
     {
-        FIXME("not implemented\n");
+        static int once;
+        if (!once++) FIXME("not implemented\n");
         return E_NOTIMPL;
     }
 
@@ -2004,7 +2013,9 @@ static HRESULT WINAPI TextFont_SetEmboss(ITextFont *iface, LONG value)
 static HRESULT WINAPI TextFont_GetForeColor(ITextFont *iface, LONG *value)
 {
     ITextFontImpl *This = impl_from_ITextFont(iface);
-    FIXME("(%p)->(%p): stub\n", This, value);
+    static int once;
+
+    if (!once++) FIXME("(%p)->(%p): stub\n", This, value);
 
     if (!value)
         return E_INVALIDARG;
@@ -2081,7 +2092,8 @@ static HRESULT WINAPI TextFont_GetItalic(ITextFont *iface, LONG *value)
         return CO_E_RELEASED;
     if (!This->txtRge)
     {
-        FIXME("not implemented\n");
+        static int once;
+        if (!once++) FIXME("not implemented\n");
         return E_NOTIMPL;
     }
 
@@ -2124,7 +2136,9 @@ static HRESULT WINAPI TextFont_SetKerning(ITextFont *iface, FLOAT value)
 static HRESULT WINAPI TextFont_GetLanguageID(ITextFont *iface, LONG *value)
 {
     ITextFontImpl *This = impl_from_ITextFont(iface);
-    FIXME("(%p)->(%p): stub\n", This, value);
+    static int once;
+
+    if (!once++) FIXME("(%p)->(%p): stub\n", This, value);
 
     if (!This->reOle)
         return CO_E_RELEASED;
@@ -2261,7 +2275,9 @@ static HRESULT WINAPI TextFont_SetShadow(ITextFont *iface, LONG value)
 static HRESULT WINAPI TextFont_GetSize(ITextFont *iface, FLOAT *value)
 {
     ITextFontImpl *This = impl_from_ITextFont(iface);
-    FIXME("(%p)->(%p): stub\n", This, value);
+    static int once;
+
+    if (!once++) FIXME("(%p)->(%p): stub\n", This, value);
 
     if (!value)
         return E_INVALIDARG;
@@ -2330,7 +2346,9 @@ static HRESULT WINAPI TextFont_SetSpacing(ITextFont *iface, FLOAT value)
 static HRESULT WINAPI TextFont_GetStrikeThrough(ITextFont *iface, LONG *value)
 {
     ITextFontImpl *This = impl_from_ITextFont(iface);
-    FIXME("(%p)->(%p): stub\n", This, value);
+    static int once;
+
+    if (!once++) FIXME("(%p)->(%p): stub\n", This, value);
 
     if (!value)
         return E_INVALIDARG;
@@ -2355,7 +2373,9 @@ static HRESULT WINAPI TextFont_SetStrikeThrough(ITextFont *iface, LONG value)
 static HRESULT WINAPI TextFont_GetSubscript(ITextFont *iface, LONG *value)
 {
     ITextFontImpl *This = impl_from_ITextFont(iface);
-    FIXME("(%p)->(%p): stub\n", This, value);
+    static int once;
+
+    if (!once++) FIXME("(%p)->(%p): stub\n", This, value);
 
     if (!value)
       return E_INVALIDARG;
@@ -2405,7 +2425,9 @@ static HRESULT WINAPI TextFont_SetSuperscript(ITextFont *iface, LONG value)
 static HRESULT WINAPI TextFont_GetUnderline(ITextFont *iface, LONG *value)
 {
     ITextFontImpl *This = impl_from_ITextFont(iface);
-    FIXME("(%p)->(%p): stub\n", This, value);
+    static int once;
+
+    if (!once++) FIXME("(%p)->(%p): stub\n", This, value);
 
     if (!value)
         return E_INVALIDARG;
@@ -2430,7 +2452,9 @@ static HRESULT WINAPI TextFont_SetUnderline(ITextFont *iface, LONG value)
 static HRESULT WINAPI TextFont_GetWeight(ITextFont *iface, LONG *value)
 {
     ITextFontImpl *This = impl_from_ITextFont(iface);
-    FIXME("(%p)->(%p): stub\n", This, value);
+    static int once;
+
+    if (!once++) FIXME("(%p)->(%p): stub\n", This, value);
 
     if (!This->reOle)
         return CO_E_RELEASED;
@@ -2721,7 +2745,9 @@ static HRESULT WINAPI TextPara_SetStyle(ITextPara *iface, LONG value)
 static HRESULT WINAPI TextPara_GetAlignment(ITextPara *iface, LONG *value)
 {
     ITextParaImpl *This = impl_from_ITextPara(iface);
-    FIXME("(%p)->(%p)\n", This, value);
+    static int once;
+
+    if (!once++) FIXME("(%p)->(%p)\n", This, value);
 
     if (!This->reOle)
         return CO_E_RELEASED;
-- 
2.4.0

