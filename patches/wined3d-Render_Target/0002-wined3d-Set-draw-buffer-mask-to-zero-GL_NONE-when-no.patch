From f0c26f58cc4c774adde80d9b8c02ca7b94adcaa9 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Michael=20M=C3=BCller?= <michael@fds-team.de>
Date: Sat, 21 Jan 2017 22:17:32 +0100
Subject: wined3d: Set draw buffer mask to zero (GL_NONE) when no render target
 view is attached.

---
 dlls/wined3d/context.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/dlls/wined3d/context.c b/dlls/wined3d/context.c
index 6112b40e60f..d168c959e30 100644
--- a/dlls/wined3d/context.c
+++ b/dlls/wined3d/context.c
@@ -2724,7 +2724,7 @@ static DWORD find_draw_buffers_mask(const struct wined3d_context *context, const
     if (wined3d_settings.offscreen_rendering_mode != ORM_FBO)
         return context_generate_rt_mask_no_fbo(context, wined3d_rendertarget_view_get_surface(rts[0])->container);
     else if (!context->render_offscreen)
-        return context_generate_rt_mask_from_resource(rts[0]->resource);
+        return rts[0] ? context_generate_rt_mask_from_resource(rts[0]->resource) : 0;
 
     rt_mask = ps ? ps->reg_maps.rt_mask : 1;
     rt_mask &= context->d3d_info->valid_rt_mask;
-- 
2.11.0

