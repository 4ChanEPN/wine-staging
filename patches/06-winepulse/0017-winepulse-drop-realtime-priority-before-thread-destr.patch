From 94b06acf43a3687efabf329ab32190ebc54147e5 Mon Sep 17 00:00:00 2001
From: Maarten Lankhorst <maarten.lankhorst@canonical.com>
Date: Tue, 24 Jun 2014 08:48:47 +0200
Subject: [PATCH 24/43] winepulse: drop realtime priority before thread
 destruction

prevents having to handle a kernel RT Watchdog Timeout.
---
 dlls/winepulse.drv/mmdevdrv.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/dlls/winepulse.drv/mmdevdrv.c b/dlls/winepulse.drv/mmdevdrv.c
index 7c07f54..ba68102 100644
--- a/dlls/winepulse.drv/mmdevdrv.c
+++ b/dlls/winepulse.drv/mmdevdrv.c
@@ -101,6 +101,8 @@ BOOL WINAPI DllMain(HINSTANCE dll, DWORD reason, void *reserved)
         }
         DisableThreadLibraryCalls(dll);
     } else if (reason == DLL_PROCESS_DETACH) {
+        if (pulse_thread)
+           SetThreadPriority(pulse_thread, 0);
         if (pulse_ctx) {
            pa_context_disconnect(pulse_ctx);
            pa_context_unref(pulse_ctx);
-- 
2.0.0

