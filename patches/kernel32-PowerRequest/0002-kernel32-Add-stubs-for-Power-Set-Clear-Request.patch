From cebca02c89236793ddfbab05adf8dd557b9c6ae4 Mon Sep 17 00:00:00 2001
From: Sebastian Lackner <sebastian@fds-team.de>
Date: Fri, 27 Mar 2015 06:59:11 +0100
Subject: kernel32: Add stubs for Power{Set,Clear}Request.

---
 dlls/kernel32/kernel32.spec |  4 ++--
 dlls/kernel32/powermgnt.c   | 22 ++++++++++++++++++++++
 include/winbase.h           |  6 ++++++
 3 files changed, 30 insertions(+), 2 deletions(-)

diff --git a/dlls/kernel32/kernel32.spec b/dlls/kernel32/kernel32.spec
index fd1d625..0b90e3c 100644
--- a/dlls/kernel32/kernel32.spec
+++ b/dlls/kernel32/kernel32.spec
@@ -1134,9 +1134,9 @@
 @ stdcall PeekConsoleInputW(ptr ptr long ptr)
 @ stdcall PeekNamedPipe(long ptr long ptr ptr ptr)
 @ stdcall PostQueuedCompletionStatus(long long ptr ptr)
-# @ stub PowerClearRequest
+@ stdcall PowerClearRequest(ptr long)
 @ stdcall PowerCreateRequest(ptr)
-# @ stub PowerSetRequest
+@ stdcall PowerSetRequest(ptr long)
 @ stdcall PrepareTape(ptr long long)
 @ stub PrivCopyFileExW
 @ stub PrivMoveFileIdentityW
diff --git a/dlls/kernel32/powermgnt.c b/dlls/kernel32/powermgnt.c
index 74ec397..b5bd0d9 100644
--- a/dlls/kernel32/powermgnt.c
+++ b/dlls/kernel32/powermgnt.c
@@ -111,3 +111,25 @@ HANDLE WINAPI PowerCreateRequest(REASON_CONTEXT *context)
     SetLastError(ERROR_CALL_NOT_IMPLEMENTED);
     return INVALID_HANDLE_VALUE;
 }
+
+/***********************************************************************
+ *           PowerSetRequest      (KERNEL32.@)
+ */
+BOOL WINAPI PowerSetRequest(HANDLE request, POWER_REQUEST_TYPE type)
+{
+    FIXME("(%p, %u): stub\n", request, type);
+
+    SetLastError(ERROR_CALL_NOT_IMPLEMENTED);
+    return FALSE;
+}
+
+/***********************************************************************
+ *           PowerClearRequest      (KERNEL32.@)
+ */
+BOOL WINAPI PowerClearRequest(HANDLE request, POWER_REQUEST_TYPE type)
+{
+    FIXME("(%p, %u): stub\n", request, type);
+
+    SetLastError(ERROR_CALL_NOT_IMPLEMENTED);
+    return FALSE;
+}
diff --git a/include/winbase.h b/include/winbase.h
index 58ed07c..6683312 100644
--- a/include/winbase.h
+++ b/include/winbase.h
@@ -865,6 +865,12 @@ typedef struct _SYSTEM_POWER_STATUS
   DWORD   BatteryFullLifeTime;
 } SYSTEM_POWER_STATUS, *LPSYSTEM_POWER_STATUS;
 
+typedef enum _POWER_REQUEST_TYPE
+{
+    PowerRequestDisplayRequired,
+    PowerRequestSystemRequired,
+    PowerRequestAwayModeRequired
+} POWER_REQUEST_TYPE, *PPOWER_REQUEST_TYPE;
 
 typedef struct _SYSTEM_INFO
 {
-- 
2.3.3

