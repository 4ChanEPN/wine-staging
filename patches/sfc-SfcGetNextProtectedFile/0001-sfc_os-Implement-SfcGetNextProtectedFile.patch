From b8ea046850c5c8e6b0a40d1414ca2ec7623266b7 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Michael=20M=C3=BCller?= <michael@fds-team.de>
Date: Sat, 31 Oct 2015 16:41:46 +0100
Subject: sfc_os: Implement SfcGetNextProtectedFile.

---
 dlls/sfc/sfc.spec       |  2 +-
 dlls/sfc_os/sfc_os.c    | 11 +++++++++++
 dlls/sfc_os/sfc_os.spec |  2 +-
 3 files changed, 13 insertions(+), 2 deletions(-)

diff --git a/dlls/sfc/sfc.spec b/dlls/sfc/sfc.spec
index 04307d2..bdd66db 100644
--- a/dlls/sfc/sfc.spec
+++ b/dlls/sfc/sfc.spec
@@ -7,7 +7,7 @@
 7 stub @
 8 stub @
 9 stub @
-@ stub SfcGetNextProtectedFile
+@ stdcall SfcGetNextProtectedFile(long ptr) sfc_os.SfcGetNextProtectedFile
 @ stdcall SfcIsFileProtected(ptr wstr) sfc_os.SfcIsFileProtected
 @ stdcall SfcIsKeyProtected(long wstr long) sfc_os.SfcIsKeyProtected
 @ stub SfcWLEventLogoff
diff --git a/dlls/sfc_os/sfc_os.c b/dlls/sfc_os/sfc_os.c
index 5805342..fab4094 100644
--- a/dlls/sfc_os/sfc_os.c
+++ b/dlls/sfc_os/sfc_os.c
@@ -123,3 +123,14 @@ BOOL WINAPI SfcIsKeyProtected(HKEY hKey, LPCWSTR lpSubKey, REGSAM samDesired)
     SetLastError(ERROR_FILE_NOT_FOUND);
     return FALSE;
 }
+
+/******************************************************************
+ *              SfcGetNextProtectedFile     [sfc_os.@]
+ */
+BOOL WINAPI SfcGetNextProtectedFile(HANDLE rpc, PROTECTED_FILE_DATA *data)
+{
+    FIXME("(%p, %p) stub\n", rpc, data);
+
+    SetLastError(ERROR_NO_MORE_FILES);
+    return FALSE;
+}
diff --git a/dlls/sfc_os/sfc_os.spec b/dlls/sfc_os/sfc_os.spec
index 1edcb83..6b216e0 100644
--- a/dlls/sfc_os/sfc_os.spec
+++ b/dlls/sfc_os/sfc_os.spec
@@ -1,3 +1,3 @@
-@ stub SfcGetNextProtectedFile
+@ stdcall SfcGetNextProtectedFile(long ptr)
 @ stdcall SfcIsFileProtected(ptr wstr)
 @ stdcall SfcIsKeyProtected(long wstr long)
-- 
2.6.1

