From 822a4ee7b6ac2923a96393b934e1c51e3204d45c Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Michael=20M=C3=BCller?= <michael@fds-team.de>
Date: Sun, 17 Jan 2016 01:45:30 +0100
Subject: combase: Implement RoActivateInstance.

---
 dlls/combase/combase.spec |  2 +-
 dlls/combase/roapi.c      | 20 ++++++++++++++++++++
 2 files changed, 21 insertions(+), 1 deletion(-)

diff --git a/dlls/combase/combase.spec b/dlls/combase/combase.spec
index 5082f39..9b1ab30 100644
--- a/dlls/combase/combase.spec
+++ b/dlls/combase/combase.spec
@@ -242,7 +242,7 @@
 @ stdcall PropVariantClear(ptr) ole32.PropVariantClear
 @ stdcall PropVariantCopy(ptr ptr) ole32.PropVariantCopy
 @ stub ReleaseFuncDescs
-@ stub RoActivateInstance
+@ stdcall RoActivateInstance(ptr ptr)
 @ stub RoCaptureErrorContext
 @ stub RoClearError
 @ stub RoFailFastWithErrorContext
diff --git a/dlls/combase/roapi.c b/dlls/combase/roapi.c
index 6fd4df5..695b6fd 100644
--- a/dlls/combase/roapi.c
+++ b/dlls/combase/roapi.c
@@ -184,3 +184,23 @@ done:
     if (module) FreeLibrary(module);
     return hr;
 }
+
+/***********************************************************************
+ *      RoActivateInstance (combase.@)
+ */
+HRESULT WINAPI RoActivateInstance(HSTRING classid, IInspectable **instance)
+{
+    IActivationFactory *factory;
+    HRESULT hr;
+
+    FIXME("(%s, %p): semi-stub\n", debugstr_hstring(classid), instance);
+
+    hr = RoGetActivationFactory(classid, &IID_IActivationFactory, (void **)&factory);
+    if (SUCCEEDED(hr))
+    {
+        hr = IActivationFactory_ActivateInstance(factory, instance);
+        IActivationFactory_Release(factory);
+    }
+
+    return hr;
+}
-- 
2.6.4

